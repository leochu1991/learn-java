[TOC]

### `JAVA` 内存区域划分

#### `JAVA` 执行过程

> `java` 源代码 ==> `java` 字节码 ==> `class loader` 类加载器 ==> `execution engine` 执行引擎 ==> `runtime data area` 运行时数据区

#### `Runtime Data Area` 组成

+ 程序计数器 ( `program counter register` )
+ `java` 栈 ( `vm stack` )
+ 本地方法栈 ( `native method stack` )
+ 堆 ( `heap` )
+ 方法区 ( `method area` )

#### `Runtime Data Area` 各部分存储数据

#### 程序计数器

（线程私有）保存当前线程需要执行的指令地址，数据所占空间不会改变。

#### `java` 栈

（线程私有）栈中保存了栈帧，一个栈帧对应于一个被调用的方法，每个栈帧中包含：

> + 局部变量表 ( `local variables` )：存储方法中的局部变量，包括方法声明中的非静态变量、方法形参等。对于基本变量，存储值；对于引用类型变量，存储引用，在编译器确定大小，运行时不改变。
> + 操作数栈 ( `operand stack` )：用于程序的计算过程，如表达式求值。
> + 指向运行时常量池的引用 ( `reference to runtime constant pool` )：存储类的常量的引用。
> + 方法返回地址 ( `return address` )：方法执行完成之后，返回方法调用处，该地址由栈帧存储。
> + 附加信息

当线程执行方法时，就创建一个对应的栈帧，并将栈帧压栈，当方法执行完成后，将栈帧出栈。

#### 本地方法栈

（线程私有）与 `java` 栈类似，`java` 栈执行 `java` 方法，本地方法栈执行 `native method` 方法， `hotspot` 虚拟机中合二为一。

#### 堆

（线程共享）存储对象和数组，数组引用存放在 `java` 栈中，由垃圾回收器管理。

#### 方法区

（线程共享）存储类信息（类名称、方法信息、字段信息）、静态变量、常量池、编译器编译后的代码。常量池用于存储编译期生成的字面量和符号引用以及运行时生成的常量。